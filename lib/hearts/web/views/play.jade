extends ./layout

block head
  link(rel="stylesheet", type="text/css", href="./lib/cards/cards.css", media="screen")
  //if lt IE 9
    link(rel="stylesheet", type="text/css", href="./lib/cards/cards-ie.css", media="screen")
  //if IE 9
    link(rel="stylesheet", type="text/css", href="./lib/cards/cards-ie9.css", media="screen")
  != css('style')

  script(src='./lib/thrift.js')
  script(src='./lib/types/hearts_types.js')
  script(src='./lib/types/Hearts.js')
  != js('controllers')
  != js('services')
  != js('filters')
  != js('app')


mixin cardBody
  span.rank {{card.rank | rankName | uppercase}}
  span.suit(ng-show="card.suit == Suits.CLUBS") &clubs;
  span.suit(ng-show="card.suit == Suits.DIAMONDS") &diams;
  span.suit(ng-show="card.suit == Suits.SPADES") &spades;
  span.suit(ng-show="card.suit == Suits.HEARTS") &hearts;

mixin cardInput
  label(class="card {{card.suit | cardSuitClass}} rank-{{card.rank | rankName}}")
    mixin cardBody
    input(type="checkbox", ng-model="card.checked")

mixin cardDiv
  div(class="card {{card.suit | cardSuitClass}} rank-{{card.rank | rankName}}")
    mixin cardBody

mixin position(position)
  h1= position
  p score: {{positions.#{position}.score}}
  .player(ng-class="{ human: position.player == '#{position}' }")

block content
  div(ng-app="AgentVsAgent")
    div(ng-controller='HeartsCtrl')
      .container-fluid
        .row-fluid.cardTable
          .span12
            .row-fluid
              .span12
                .info {{trick}}
                .round {{roundResult}}
                .game {{gameResult}}
            .row-fluid
              .span4
              .span4
                mixin position("north")
              .span4
            .row-fluid
              .span4
                mixin position("west")
              .span4
                div(ng-show="state.currentState == 'unstarted'")
                  button.startGame(ng-click="startGame()") start the game
                div(ng-show="state.currentState == 'waitingForGame'")
                  p Waiting for a game
                .playingCards
                  ul.table
                    li(ng-repeat="card in state.trick.played")
                      mixin cardDiv
              .span4
                mixin position("east")
            .row-fluid
              .span4
              .span4
                mixin position("south")
              .span4
            .row-fluid
              .span-12
                .playingCards
                  h1 HAND:
                  ul.table
                    li(ng-repeat="card in state.hand")
                      mixin cardInput
                  button(ng-show="state.currentState == 'passing'", ng-click="pass()") Pass
                  button(ng-show="state.currentState == 'playing'", ng-click="play()") Play


